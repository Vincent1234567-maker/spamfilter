<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <title>AI Textanalys</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <style>
        body { font-family: sans-serif; background: #f0f2f5; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); width: 100%; max-width: 500px; }
        textarea { width: 100%; height: 100px; margin: 10px 0; border-radius: 5px; border: 1px solid #ccc; padding: 10px; box-sizing: border-box; }
        button { width: 100%; background: #007bff; color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; }
        #debug { margin-top: 20px; background: #222; color: #0f0; padding: 15px; border-radius: 5px; width: 100%; max-width: 500px; font-family: monospace; font-size: 12px; }
    </style>
</head>
<body>

<div class="card">
    <h2>üìù Textanalys AI</h2>
    <p id="status">‚è≥ Laddar modell...</p>
    <div id="ui" style="display:none;">
        <textarea id="textInput" placeholder="Skriv din text h√§r..."></textarea>
        <button onclick="classify()">Analysera text</button>
        <h3 id="result">Resultat: -</h3>
    </div>
</div>

<div id="debug"><strong>Logg:</strong><div id="log"></div></div>

<script>
    let model;
    const logEl = document.getElementById('log');

    function log(msg) { logEl.innerHTML += `> ${msg}<br>`; }

    async function init() {
        // MATCHAR DITT MAPP-NAMN: tjfs_model
        const path = './tjfs_model/model.json';
        log(`H√§mtar fr√•n: ${path}`);
        
        try {
            model = await tf.loadLayersModel(path);
            log("‚úÖ Modell laddad!");
            document.getElementById('status').innerText = "‚úÖ Klar";
            document.getElementById('ui').style.display = "block";
        } catch (err) {
            log(`‚ùå Fel: ${err.message}`);
        }
    }

    async function classify() {
        const text = document.getElementById('textInput').value;
        log(`Analyse: ${text}`);
        
        try {
            // Skapar en enkel "dummy"-input f√∂r att testa att modellen k√∂rs
            // Obs: Denna rad beh√∂ver vi justera senare f√∂r att matcha din modells input-krav
            const input = tf.ones([1, 30]); 
            const pred = model.predict(input);
            const data = await pred.data();
            document.getElementById('result').innerText = `Resultat: ${data[0].toFixed(4)}`;
            log(`Klar! Svar: ${data[0]}`);
        } catch (e) {
            log(`‚ùå K√∂rningsfel: ${e.message}`);
        }
    }
    init();
</script>
</body>
</html>
