<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Textanalys</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 500px; }
        textarea { width: 100%; height: 100px; margin: 15px 0; border: 1px solid #ccc; border-radius: 8px; padding: 10px; box-sizing: border-box; resize: none; }
        button { width: 100%; background: #007bff; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold; }
        button:hover { background: #0056b3; }
        #debug { margin-top: 20px; background: #1e1e1e; color: #00ff00; padding: 15px; border-radius: 8px; width: 100%; max-width: 500px; font-family: monospace; font-size: 12px; }
        .status-ok { color: green; font-weight: bold; }
        .status-err { color: red; font-weight: bold; }
    </style>
</head>
<body>

<div class="card">
    <h2>üìù AI-Textanalys</h2>
    <p id="status">‚è≥ Kontrollerar filer...</p>
    
    <div id="ui" style="display:none;">
        <textarea id="textInput" placeholder="Skriv n√•got h√§r f√∂r att testa modellen..."></textarea>
        <button onclick="analyze()">Analysera</button>
        <h3 id="result">Resultat: -</h3>
    </div>
</div>

<div id="debug">
    <strong>Systemlogg:</strong><hr>
    <div id="log"></div>
</div>

<script>
    let model;
    const logBox = document.getElementById('log');

    function printLog(msg) {
        logBox.innerHTML += `> ${msg}<br>`;
        console.log(msg);
    }

    async function init() {
        // H√ÑR √ÑR FIXEN: Vi √§ndrar fr√•n tfjs till tjfs f√∂r att matcha din GitHub-mapp!
        const modelPath = './tjfs_model/model.json';
        printLog(`F√∂rs√∂ker ladda fr√•n: ${modelPath}`);

        try {
            model = await tf.loadLayersModel(modelPath);
            printLog("‚úÖ Framg√•ng! Modellen hittades och laddades.");
            document.getElementById('status').innerHTML = '<span class="status-ok">‚úÖ Modellen √§r laddad!</span>';
            document.getElementById('ui').style.display = "block";
        } catch (err) {
            printLog(`‚ùå FEL: ${err.message}`);
            document.getElementById('status').innerHTML = '<span class="status-err">‚ùå Hittade inte modellen.</span>';
        }
    }

    async function analyze() {
        const text = document.getElementById('textInput').value;
        if(!text) return;

        printLog(`Analyserar text...`);
        
        try {
            // OBS: Textmodeller kr√§ver oftast att man g√∂r om text till siffror (tokens).
            // Det h√§r √§r ett enkelt test f√∂r att se att modellen svarar:
            const testInput = tf.ones([1, 10]); // Vi skickar in 10 "ettor" som test
            const prediction = model.predict(testInput);
            const data = await prediction.data();
            
            document.getElementById('result').innerText = `Resultat: ${data[0].toFixed(4)}`;
            printLog(`K√∂rning klar! V√§rde: ${data[0]}`);
        } catch (err) {
            printLog(`‚ùå K√∂rningsfel: ${err.message}`);
            printLog(`Tips: Din modell f√∂rv√§ntar sig troligen en annan 'shape' p√• inputen √§n [1, 10].`);
        }
    }

    init();
</script>
</body>
</html>
